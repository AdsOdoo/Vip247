<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>
		<report string="Calculo ISR Anual" 
			id="action_report_calculo_isr_anual"
			model="calculo.isr.anual" 
			report_type="qweb-pdf"
			name="nomina_cfdi_extras_ee.report_calculo_isr_anual" 
			file="nomina_cfdi_extras_ee.report_calculo_isr_anual" 
		/>
	</data>
	<template id="report_calculo_isr_anual">
			<t t-call="web.html_container">
			<div class="header">
			<div class="row">
                <div class="col-xs-12">
                	<center>
                		<h2 style="margin-top: 0px;margin-bottom: 5px;"><span t-esc="data['company_name']" /></h2>
                	</center>
                </div>
            </div>
            <br/>
            <br/>
            <div class="row">
                <div class="col-xs-12">
                	<span t-esc="time.strftime('%d/%m/%Y')" /><br/>
                	<span t-esc="data['company_rfc']" /><br/>
                </div>
            </div>
            </div>
            
	       	<div class="article o_report_layout_standard">
				<div class="page">
					<div class="oe_structure" />
		            <br/>
		            <div class="row">
		                <div class="col-xs-12">
		                	<center>
		                		<h4>Reporte de differencies entre ISR retenido vs calculo anual</h4>
		                	</center>
		                </div>
		            </div>
		            <div class="row">
		                <div class="col-xs-12">
		                	<strong>Nomina</strong> <span t-esc="time.strftime('%d/%m/%Y')" />
		                	<strong>Tipo de calculo: </strong> anual
		                </div>
		            </div>
		            <br />
					<div class="row">
						
						<t t-set="all_col_dict" t-value="data['result']" />
						<t t-set="all_col_list" t-value="data['all_col_list_seq']" />
						<t t-set="total_by_code" t-value="data['total_by_code']" />
						<t t-set="emp_by_ids" t-value="data['emp_by_ids']" />
						
						<table class="table table-condensed table table-striped">
							<thead>
								<tr>
									<th>Empleado</th>
									<t t-foreach="all_col_list" t-as="col">
										<th><t t-esc="col"/></th>
									</t>
								</tr>
							</thead>
							
							<tr t-foreach="all_col_dict" t-as="emp_id">
								<td>
									<span t-esc="emp_by_ids[emp_id]"/>
								</td>
								<t t-foreach="all_col_list" t-as="col">
									<td>
										<span t-esc="round(all_col_dict[emp_id].get(col,0),2)"/>
									</td>
								</t>
							</tr>
							<tr>
								<td>
									<strong>
										<span>Totales</span>
									</strong>
								</td>						
								
								<t t-foreach="all_col_list" t-as="col">
									<th>
										<span t-esc="round(total_by_code[col],2)"/>
									</th>
								</t>
							</tr>
						</table>
					</div>
				</div>
			</div>
			</t>
	</template>
</odoo>
